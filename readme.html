<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
<head>
	<title>Snitz Forums MOD - Sticky Topic Separator</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="author" content="Bill Parrott" />
	<meta name="robots" content="index,follow" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<script type="text/javascript">
		//<![CDATA[
		function loadChanges(strFile) {
			var newInnerHTML = document.getElementById(strFile).innerHTML;
			document.getElementById('installTxt').innerHTML = '';
			document.getElementById('installTxt').innerHTML = newInnerHTML;
		}
		//]]>
	</script>
	<style type="text/css">
		/*<![CDATA[*/
		* {margin: 0; padding: 0; border: 0;}
		.left {float: left;}
		.right {float: right;}
		.clear {clear: both;}
		.rClear {clear: right;}
		.lClear {clear: left;}
		
		body {text-align: center; background-color: #404040;}
		a:link {}
		a:hover {}
		a:visited {}
		a:active {}
		a.nolink {}
		h1 {}
		h2 {}
		h3 {margin-top: 1em; border-bottom: 1px solid #8080a0;}
		h4 {margin-top: 1em;}
		p {text-indent: 2em;}

		#wrapper {width: 750px; margin: 10px auto; text-align: left;}

		#header {border: 1px solid #8080a0; border-width: 1px 1px 0 1px; text-align: center; padding: 15px; background-color: #8080a0;}

		#globalNav {border: 1px solid #e0e0e0; border-width: 0 1px; background-color: #e0e0e0;}
		#globalNav ul {list-style-type: none; margin-left: 25px;}
		#globalNav ul li {float: left; display: block; width: 100px; text-align: center;}
		/*#globalNav ul li a {display: block; width: 100%;}*/

		#content {border: 1px solid #e0e0e0; border-width: 0 1px; padding: 15px; background-color: #e0e0e0;}

		#descriptionDiv {}

		#installationDiv {}
		#installationDifficulty {text-align: center;}
		#difficultyBar {}
		#installTxt {background-color: #fff; width: 650px; margin: 1em 25px; border: 1px solid #8080a0; height: 375px; overflow: scroll; padding: 5px;}
		#installTxt h4 {margin-top: 0;}
		#installTxt .txtChanges {background-color: #e0e0e0; border: 1px solid #e0e0e0; width: 100%; height: 250px; overflow: scroll;}
		.reqChange {color: #f00;}
		.optChange {color: #0a0;}
		#installationDiv ul, #installationDiv ol, #changelogDiv ul, #uninstallationDiv ol {margin-left: 2em;}

		#upgradingDiv {}

		#featuresDiv {}

		#uninstallationDiv {}

		#changelogDiv {}

		#faqDiv {}

		#footer {border: 1px solid #8080a0; border-width: 1px 1px 0 1px; text-align: center; padding: 15px; background-color: #8080a0;}
		
		/* Hidden <div> elements containing the installation procedures */
		#file1, #file2, #file3, #file4, #file5, #file6, #file7, #file8, #file9, #file10,
		#file11, #file12, #file13, #file14, #file15, #file16, #file17, #file18, #file19, #file20 {height: 0px; width: 0px; display: none;}
		/*]]>*/
	</style>
	<!--[if IE]>
	<style type="text/css">
		/*<![CDATA[*/

		/*]]>*/
	</style>
	<![endif]-->
</head>
<body>
	<div id="wrapper">
		<div id="header">
			<h1>Snitz Forums MOD - Sticky Topic Separator</h1>
		</div>
		<div id="globalNav">
			<ul>
				<li><a href="#description" title="General overview"><span>Description</span></a></li>
				<li><a href="#installation" title="Installation instructions"><span>Installation</span></a></li>
				<!--<li><a href="#upgrading" title="Upgrading the MOD from an older version"><span>Upgrading</span></a></li>-->
				<!--<li><a href="#features" title="Instructions on how to use the MOD's features"><span>Features</span></a></li>-->
				<li><a href="#uninstallation" title="How to uninstall the MOD"><span>Uninstallation</span></a></li>
				<li><a href="#changelog" title="Changes made to the MOD from version to version"><span>Change Log</span></a></li>
				<!--<li><a href="#faq" title="Frequently Asked Questions about this MOD"><span>FAQ</span></a></li>-->
			</ul>
			<br class="clear" />
		</div>
		<div id="content">
			<h3><a name="description" class="nolink">Description</a></h3>
			<div id="descriptionDiv">
				<strong>Version:</strong> 1.0<br />
				<strong>Author:</strong> Bill Parrott (<a href="http://forum.snitz.com/forum/pop_profile.asp?mode=display&amp;id=32088" title="View my profile at the Snitz forums" onclick="return !window.open(this.href);">muzishun</a>)<br />
				<strong>Forum Version:</strong> Snitz Forum 2000 v3.4.06<br />
				<strong>Tested Databases:</strong> n/a<br />
				<strong>Last Updated:</strong> 2007/12/05<br />
				<strong>Download Link:</strong> LINK<br />
				<p id="descNotes">This MOD helps distinguish between sticky topics and regular topics on forum.asp. Sticky topics remain above the rest of the topics, but they are labeled with a header of "Important Topics". The rest of the topics are separated by a bar reading "Forum Topics". This helps clarify the intent of sticky topics.</p>
				<p id="descSupport">For support, please visit the <a href="http://forum.snitz.com/forum/forum.asp?FORUM_ID=94" title="MOD Implementation forum; please direct your questions here" onclick="return !window.open(this.href);">MOD Implementation</a> forum at the Snitz website.</p>
			</div>
			<h3><a name="installation" class="nolink">Installation</a></h3>
			<div id="installationDiv">
				<div id="installationDifficulty">
					<strong>Installation Difficulty</strong><br />
					<span id="difficultyBar">easy - X | - - - | - - - | - - - | - - hard</span>
				</div>
				<h4>Backup your files</h4>
				<p>Before installing this mod, you should create backups of your database along with any files listed in the <strong>Changed Files</strong> list below. Changes that are required for the MOD are highlighted in <span class="reqChange">red</span>, while changes that are not required are highlighted in <span class="optChange">green</span>. Optional changes will be explained below the text box in which they occur.</p>
				<p>If you have not made any changes to the files listed below in the <strong>Changed Files</strong> list, you can overwrite your current copies with the ones provided with this MOD.</p>
				<h4>Changed Files:</h4>
				<ul>
					<li><a href="javascript:loadChanges('file1');" title="View changes for this file">forum.asp</a></li>
				</ul>
				<h4>Installation Process</h4>
				<div id="file1">
					<h4>Installation instructions for: forum.asp</h4>
					Find this block of code at lines 457-528:<br />
<div class="txtChanges"><pre>
	rec = 1
	for iTopic = 0 to iTopicCount
		if (rec = strPageSize + 1) then exit for

		Topic_Status = arrTopicData(tT_STATUS, iTopic)
		Topic_CatID = arrTopicData(tCAT_ID, iTopic)
		Topic_ForumID = arrTopicData(tFORUM_ID, iTopic)
		Topic_ID = arrTopicData(tTOPIC_ID, iTopic)
		Topic_ViewCount = arrTopicData(tT_VIEW_COUNT, iTopic)
		Topic_Subject = arrTopicData(tT_SUBJECT, iTopic)
		Topic_Author = arrTopicData(tT_AUTHOR, iTopic)
		Topic_Sticky = arrTopicData(tT_STICKY, iTopic)
		Topic_Replies = arrTopicData(tT_REPLIES, iTopic)
		Topic_UReplies = arrTopicData(tT_UREPLIES, iTopic)
		Topic_LastPost = arrTopicData(tT_LAST_POST, iTopic)
		Topic_LastPostAuthor = arrTopicData(tT_LAST_POST_AUTHOR, iTopic)
		Topic_LastPostReplyID = arrTopicData(tT_LAST_POST_REPLY_ID, iTopic)
		Topic_MName = arrTopicData(tM_NAME, iTopic)
		Topic_LastPostAuthorName = arrTopicData(tLAST_POST_AUTHOR_NAME, iTopic)

		if AdminAllowed = 1 and Topic_UReplies &gt; 0 then
			Topic_Replies = Topic_Replies + Topic_UReplies
		end if
		Response.Write	"              &lt;tr&gt;" &amp; vbNewLine &amp; _
				"                &lt;td bgcolor=""" &amp; strForumCellColor &amp; """ align=""center"" valign=""middle""&gt;&lt;a href=""topic.asp?" &amp; ArchiveLink &amp; "TOPIC_ID=" &amp; Topic_ID &amp; """&gt;"
		if Cat_Status &lt;&gt; 0 and Forum_Status &lt;&gt; 0 and Topic_Status &lt;&gt; 0 then
			if Topic_Sticky and strStickyTopic = "1" then 
				if Topic_LastPost &gt; Session(strCookieURL &amp; "last_here_date") then
					Response.Write	getCurrentIcon(strIconFolderNewSticky,"New Sticky Topic","hspace=""0""")
				else
					Response.Write	getCurrentIcon(strIconFolderSticky,"Sticky Topic","hspace=""0""")
				end if
			else
				' DEM --&gt; Added code for topic moderation
				if Topic_Status = 2 then
					UnApprovedFound = "Y"
					Response.Write 	getCurrentIcon(strIconFolderUnmoderated,"Topic Not Moderated","hspace=""0""") &amp; "&lt;/a&gt;" &amp; vbNewline
				elseif Topic_Status = 3 then
					HeldFound = "Y"
					Response.Write 	getCurrentIcon(strIconFolderHold,"Topic on Hold","hspace=""0""") &amp; "&lt;/a&gt;" &amp; vbNewline
					' DEM --&gt; end of code Added for topic moderation
				else
					Response.Write	ChkIsNew(Topic_LastPost)
				end if
			end if
		else
			if ArchiveView &lt;&gt; "true" then
				if Cat_Status = 0 then
					strAltText = "Category Locked"
				elseif Forum_Status = 0 then
					strAltText = "Forum Locked"
				else
					strAltText = "Topic Locked"
				end if
			end if
			if ArchiveView = "true" then 
				Response.Write	getCurrentIcon(strIconFolderArchived,"Archived Topic","hspace=""0""")
			elseif Topic_LastPost &gt; Session(strCookieURL &amp; "last_here_date") then
				if Topic_Sticky and strStickyTopic = "1" then 
					Response.Write	getCurrentIcon(strIconFolderNewStickyLocked,strAltText,"hspace=""0""")
				else
					Response.Write	getCurrentIcon(strIconFolderNewLocked,strAltText,"hspace=""0""")
				end if
			else
				if Topic_Sticky and strStickyTopic = "1" then 
					Response.Write	getCurrentIcon(strIconFolderStickyLocked,strAltText,"hspace=""0""")
				else
					Response.Write	getCurrentIcon(strIconFolderLocked,strAltText,"hspace=""0""")
				end if
			end if
		end if
		Response.Write	"&lt;/a&gt;&lt;/td&gt;" &amp; vbNewLine &amp; _
</pre></div><br />
					Edit that block to look like this:<br />
<div class="txtChanges"><pre>
	<span class="reqChange">blnStickyTopics = False</span>
	rec = 1
	for iTopic = 0 to iTopicCount
		if (rec = strPageSize + 1) then exit for

		Topic_Status = arrTopicData(tT_STATUS, iTopic)
		Topic_CatID = arrTopicData(tCAT_ID, iTopic)
		Topic_ForumID = arrTopicData(tFORUM_ID, iTopic)
		Topic_ID = arrTopicData(tTOPIC_ID, iTopic)
		Topic_ViewCount = arrTopicData(tT_VIEW_COUNT, iTopic)
		Topic_Subject = arrTopicData(tT_SUBJECT, iTopic)
		Topic_Author = arrTopicData(tT_AUTHOR, iTopic)
		Topic_Sticky = arrTopicData(tT_STICKY, iTopic)
		Topic_Replies = arrTopicData(tT_REPLIES, iTopic)
		Topic_UReplies = arrTopicData(tT_UREPLIES, iTopic)
		Topic_LastPost = arrTopicData(tT_LAST_POST, iTopic)
		Topic_LastPostAuthor = arrTopicData(tT_LAST_POST_AUTHOR, iTopic)
		Topic_LastPostReplyID = arrTopicData(tT_LAST_POST_REPLY_ID, iTopic)
		Topic_MName = arrTopicData(tM_NAME, iTopic)
		Topic_LastPostAuthorName = arrTopicData(tLAST_POST_AUTHOR_NAME, iTopic)

		if AdminAllowed = 1 and Topic_UReplies &gt; 0 then
			Topic_Replies = Topic_Replies + Topic_UReplies
		end if

		<span class="reqChange">If blnStickyTopics = True Then
			If Topic_Sticky and strStickyTopic = "1" Then
				'Do Nothing
			Else
				'We've had sticky topics, and now we are into the regular topics
				Response.Write	"              &lt;tr&gt;&lt;td colspan=""7"" bgcolor=""" &amp; strHeadCellColor &amp; """&gt;&lt;b&gt;&lt;font face=""" &amp; strDefaultFontFace &amp; """ size=""" &amp; strDefaultFontSize &amp; """ color=""" &amp; strHeadFontColor &amp; """&gt;Forum Topics&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;" &amp; vbNewLine
				blnStickyTopics = False
			End If
		End If

		If blnStickyTopics = False Then
			If Topic_Sticky and strStickyTopic = "1" Then
				'We've got sticky topics, so we should draw the line here
				Response.Write	"              &lt;tr&gt;&lt;td colspan=""7"" bgcolor=""" &amp; strHeadCellColor &amp; """&gt;&lt;b&gt;&lt;font face=""" &amp; strDefaultFontFace &amp; """ size=""" &amp; strDefaultFontSize &amp; """ color=""" &amp; strHeadFontColor &amp; """&gt;Important Topics&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;" &amp; vbNewLine
			End If
		End If</span>

		Response.Write	"              &lt;tr&gt;" &amp; vbNewLine &amp; _
				"                &lt;td bgcolor=""" &amp; strForumCellColor &amp; """ align=""center"" valign=""middle""&gt;&lt;a href=""topic.asp?" &amp; ArchiveLink &amp; "TOPIC_ID=" &amp; Topic_ID &amp; """&gt;"
		if Cat_Status &lt;&gt; 0 and Forum_Status &lt;&gt; 0 and Topic_Status &lt;&gt; 0 then
			if Topic_Sticky and strStickyTopic = "1" then
				if Topic_LastPost &gt; Session(strCookieURL &amp; "last_here_date") then
					Response.Write	getCurrentIcon(strIconFolderNewSticky,"New Sticky Topic","hspace=""0""")
				else
					Response.Write	getCurrentIcon(strIconFolderSticky,"Sticky Topic","hspace=""0""")
				end if
				<span class="reqChange">blnStickyTopics = True</span>
			else
				' DEM --&gt; Added code for topic moderation
				if Topic_Status = 2 then
					UnApprovedFound = "Y"
					Response.Write 	getCurrentIcon(strIconFolderUnmoderated,"Topic Not Moderated","hspace=""0""") &amp; "&lt;/a&gt;" &amp; vbNewline
				elseif Topic_Status = 3 then
					HeldFound = "Y"
					Response.Write 	getCurrentIcon(strIconFolderHold,"Topic on Hold","hspace=""0""") &amp; "&lt;/a&gt;" &amp; vbNewline
					' DEM --&gt; end of code Added for topic moderation
				else
					Response.Write	ChkIsNew(Topic_LastPost)
				end if
			end if
		else
			if ArchiveView &lt;&gt; "true" then
				if Cat_Status = 0 then
					strAltText = "Category Locked"
				elseif Forum_Status = 0 then
					strAltText = "Forum Locked"
				else
					strAltText = "Topic Locked"
				end if
			end if
			if ArchiveView = "true" then
				Response.Write	getCurrentIcon(strIconFolderArchived,"Archived Topic","hspace=""0""")
			elseif Topic_LastPost &gt; Session(strCookieURL &amp; "last_here_date") then
				if Topic_Sticky and strStickyTopic = "1" then
					Response.Write	getCurrentIcon(strIconFolderNewStickyLocked,strAltText,"hspace=""0""")
					<span class="reqChange">blnStickyTopics = True</span>
				else
					Response.Write	getCurrentIcon(strIconFolderNewLocked,strAltText,"hspace=""0""")
				end if
			else
				if Topic_Sticky and strStickyTopic = "1" then
					Response.Write	getCurrentIcon(strIconFolderStickyLocked,strAltText,"hspace=""0""")
					<span class="reqChange">blnStickyTopics = True</span>
				else
					Response.Write	getCurrentIcon(strIconFolderLocked,strAltText,"hspace=""0""")
				end if
			end if
		end if
		Response.Write	"&lt;/a&gt;&lt;/td&gt;" &amp; vbNewLine &amp; _
</pre></div>
				</div>
				<div id="installTxt"></div>
			</div>
			<!--<h3><a name="upgrading" class="nolink">Upgrading</a></h3>
			<div id="upgradingDiv">
			</div>-->
			<!--<h3><a name="features" class="nolink">Features</a></h3>
			<div id="featuresDiv">
			</div>-->
			<h3><a name="uninstallation" class="nolink">Uninstallation</a></h3>
			<div id="uninstallationDiv">
				<h4>Restore using your backup files</h4>
				<p>To uninstall this mod, replace your files with the backup files you created before installing the MOD. If you did not make backups, or you have added modifications to your forum since installing this MOD, you will need to manually undo all of the changes made in each file.</p>
			</div>
			<h3><a name="changelog" class="nolink">Change Log</a></h3>
			<div id="changelogDiv">
				<h4>Version 1.0 (2007/12/05)</h4>
				<ul>
					<li>Initial release</li>
				</ul>
				<em>Modified Files: </em> forum.asp<br />
			</div>
			<!--<h3><a name="faq" class="nolink">FAQ</a></h3>
			<div id="faqDiv">
				<strong>Q: Question 1?</strong><br />
				<strong>A:</strong> Answer 1.<br /><br />
				<strong>Q: Question 2?</strong><br />
				<strong>A:</strong> Answer 2.
			</div>-->
		</div>
		<div id="footer">
			&copy; 2007 Bill Parrott &amp; Chimeric Dream<br />
		</div>
	</div>
</body>
</html>